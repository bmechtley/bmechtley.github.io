<!DOCTYPE html>
<html>
    <head>
        <title>Brandon Mechtley</title>

        <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,300' rel='stylesheet' type='text/css'>
        <link href='http://fonts.googleapis.com/css?family=Molengo' rel='stylesheet' type='text/css'>

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="author" content="Brandon Mechtley">

        <script src="https://code.createjs.com/createjs-2015.05.21.min.js" type="text/javascript"></script>

        <script type="text/javascript">
            var vals = [];
            var nvals = [];

            var mainrect;
            var rows = 32;
            var cols = 5;
            var xscale;
            var yscale;

            var automata = true;

            function rgba(r, g, b, a) {
                return "rgba(" +
                    r + "," +
                    g + "," +
                    b + "," +
                    a +
                    ")";
            }

            function init() {
                stage = new createjs.Stage("easel");
                var bounds = stage.getBounds();

                for (var row = 0; row < rows; row++) {
                    var vrow = [];
                    var nvrow = [];

                    for (var col = 0; col < cols; col++) {
                        var val = row == 0 ? Math.floor(Math.random() * 255) : 255;
                        vrow.push(val);
                        nvrow.push(val);
                    }

                    vals.push(vrow);
                    nvals.push(nvrow);
                }

                mainrect = new createjs.Shape();
                mainrect.addEventListener("pressdown", function(event) {
                    automata = false;
                });
                mainrect.addEventListener("mousedown", function(event) {
                    automata = false;
                });
                mainrect.addEventListener("mouseup", function(event) {
                    automata = true;
                });
                mainrect.addEventListener("pressup", function(event) {
                    automata = true;
                });

                stage.addChild(mainrect);
                stage.update();


                xscale = stage.canvas.width / cols;
                yscale = stage.canvas.height / rows;

                createjs.Ticker.addEventListener("tick", tick);
                createjs.Ticker.setFPS(10);
            }

            function iterate_cells(fun) {
                for (var row = 0; row < rows; row++) {
                    for (var col = 0; col < cols; col++) {
                        u = (rows + row - 1) % rows;
                        d = (rows + row + 1) % rows;
                        l = (cols + col - 1) % cols;
                        r = (cols + col + 1) % cols;

                        fun(row, col, u, d, l, r);
                    }
                }
            }

            function update_cells(row, col, u, d, l, r) {
                vals[row][col] = nvals[row][col];
            }

            function tick() {
                if (Math.random() < 0.1) {
                    automata = !automata;
                }

                iterate_cells(function(row, col, u, d, l, r) {
                    if (row < rows - 1) {
                        var top = vals[row][col];
                        var bot = vals[d][col];

                        if (bot < top) {
                             vals[row][col] = bot;
                             vals[d][col] = top;
                        }
                    }
                });

                iterate_cells(function(row, col, u, d, l, r) {
                    if (col < cols - 1) {
                        var top = vals[row][col];
                        var bot = vals[row][r];

                        if (bot < top) {
                             vals[row][col] = bot;
                             vals[row][r] = top;
                        }
                    }
                });

                 if (automata) {
                    iterate_cells(function(row, col, u, d, l, r) {
                        nvals[row][col] = (
                            (vals[u][l] + vals[u][col] + vals[u][r]) / 2 +
                            (vals[row][l] + vals[row][col] + vals[row][r]) / 2
                        ) % 255;
                    });

                    iterate_cells(update_cells);
                }

                mainrect.graphics.clear();

                iterate_cells(function(row, col, u, d, l, r) {
                    var val = vals[row][col];
                    var color = rgba(0, 0, 0, val / 512.);

                    mainrect.graphics.beginFill(color).drawRect(
                        xscale * col, yscale * row, xscale - 5, yscale - 5
                    );
                });

                stage.update();
            }
        </script>

        <style>
            body {
                font-family: 'Open Sans', 'sans-serif';
                font-weight: 300;
            }

            a {
                color: inherit;
                text-decoration: none;
            }

            .container {
                width: 38em;
                margin: auto;
                height: 32em;
                margin-top: 5em;
            }

            .easel {
                display: inline-block;

                width: 5em;
                margin-right: 1em;
                background: white;
                height: 32em;
                vertical-align: top;
            }

            .content {
                display: inline-block;
                width: 28em;
                vertical-align: top;
             }

            /* Header. */

            .profile {
                margin: 0;
                padding: 0;
            }

            .profile h1 {
                font-family: 'Molengo', 'sans-serif';
                font-size: 2em;
                /* letter-spacing: -0.05em; */
                text-transform: lowercase;
                /*line-height: 0.25em;*/
                color: #556270;
                margin: 0;
                padding: 0;
            }

            /* Biography text. */

            .bio {
                text-align: justify;
                margin: 0;
                margin-top: 2em;
            }

            .bio ul {
                padding: 0;
                margin: 0;
            }

            .bio ul ul {
                padding: 1em;
            }

            .bio li {
                list-style-type: none;
                margin-top: .5em;
            }

            .bio a {
                color: #81997F;
            }

            .page {
                text-align: right;
                color: #556270;
            }

            .page img {
                position: relative;
                top: -0.5em;
                left: 2.25em;
            }
        </style>
    </head>
    <body onload="init();">
        <div class='container'>
            <canvas class='easel' id='easel' width="50" height="320"></canvas>
            <div class='content'>
                <section class='profile'>
                    <h1>Brandon <span class='lastname'>Mechtley</span></h1>
                </section>
                <section class='bio'>
                    <ul>
                        <li>&quot;is&quot;
                            <ul>
                                <li>inspired by <a href='media/alan-watts-seeing.mp3'>wiggles</a>, <a href='https://soundcloud.com/bmechtley/noise'>noise</a>, and <a href='https://www.youtube.com/watch?v=pcHnL7aS64Y'>silence</a>.</li>
                                <li>working on computational models of population ecology at the <a href="http://kbs.ku.edu">Kansas Biological Survey</a> at the University of Kansas.</li>
                            </ul>
                        </li>

                        <li>&quot;has&quot;
                            <ul>
                                <li>an ongoing <a href='https://vimeo.com/94695852'>soundscape mapping project</a>.</li>
                                <li>a <a href='maps/index.html'>list of sound maps on the web</a>.</li>
                                <li>some <a href='http://www.mendeley.com/profiles/brandon-mechtley/'>papers</a>.</li>
                                <li>some <a href='https://soundcloud.com/bmechtley'>sounds</a>.</li>
                                <li>a <a href='cv.html'>cv</a>.</li>
                            </ul>
                        </li>
                    </ul>

                    <p class='page'><img src='images/music.png'/>00001</p>
                </section>
            </div>
        </div>
    </body>
</html>

