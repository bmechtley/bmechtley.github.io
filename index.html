<!DOCTYPE html>
<html>
    <head>
        <title>Brandon Mechtley</title>

        <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,300' rel='stylesheet' type='text/css'>
        <link href='http://fonts.googleapis.com/css?family=Molengo' rel='stylesheet' type='text/css'>

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="author" content="Brandon Mechtley">

        <script src="https://code.createjs.com/createjs-2015.05.21.min.js" type="text/javascript"></script>

        <script type="text/javascript">
            var vals = [];
            var nvals = [];

            var mainrect;
            var rows = 32;
            var cols = 5;
            var xscale;
            var yscale;

            var automata = [1, 1, 1, 1];
            var sort_horizontal = [1, 1, 1, 1];
            var sort_vertical = [1, 1, 1, 1];

            var p_automata = [0.1, 0.1, 0.1, 0.1];
            var p_sort_horizontal = [0.1, 0.1, 0.1, 0.1];
            var p_sort_vertical = [0.1, 0.1, 0.1, 0.1];

            var p_min = 0.05;
            var p_max = 0.5;

            var automata = {
                direction: [-1, -1, -1, -1],
                p: [0.1, 0.1, 0.1, 0.1],
                pMin: 0.05,
                pMax: 0.5,
                postUpdate: true,
                update: function (p) {
                    if (p.effect.direction[p.channel] != 0) {
                        drow = effect.direction[p.channel] + 1;

                        nvals[p.row][p.col][p.channel] = (
                            (p.v[1][0] + p.v[1][1] + p.v[1][2]) / 2 +
                            (p.v[drow][0] + p.v[drow][1] + p.v[drow][2]) / 2
                        ) % 100
                    }
                }
            };

            var sort_horizontal = {
                direction: [-1, -1, -1, -1],
                p: [0.1, 0.1, 0.1, 0.1],
                pMin: 0.05,
                pMax: 0.5,
                postUpdate: true,
                update: function(p) {
                    if (p.effect.direction[p.channel] != 0) {
                        if (p.col < cols - 1) {
                            swap(
                                p.row, p.col,
                                p.row, p.right,
                                p.effect.direction == -1 ? true : false,
                                p.channel
                            );
                        }
                    }
                }
            };

            var sort_vertical = {
                direction: [-1, -1, -1, -1],
                p: [0.1, 0.1, 0.1, 0.1],
                pMin: 0.05,
                pMax: 0.5,
                postUpdate: true,
                update: function(p) {
                    if (p.effect.direction[p.channel] != 0) {
                        if (p.row < rows - 1) {
                            swap(
                                p.row, p.col,
                                p.down, p.col,
                                p.effect.direction == -1 ? true : false,
                                p.channel
                            );
                        }
                    }
                }
            }

            var effects = [sort_horizontal, sort_vertical, automata];

            function rgba(r, g, b, a) {
                return "rgba(" +
                    r + "," +
                    g + "," +
                    b + "," +
                    a + ")";
            }

            function hsla(h, s, l, a) {
                return "hsla(" +
                    h + "," +
                    s + "%," +
                    l + "%," +
                    a + ")"
            }

            function init() {
                stage = new createjs.Stage("easel");
                var bounds = stage.getBounds();

                for (var row = 0; row < rows; row++) {
                    var vrow = [];
                    var nvrow = [];

                    for (var col = 0; col < cols; col++) {
                        var vcol = [];
                        var nvcol = [];

                        for (var channel = 0; channel < 4; channel ++) {
                            var val = row == 0 ? Math.floor(Math.random() * 100) : 100;
                            vcol.push(val);
                            nvcol.push(val);
                        }

                        vrow.push(vcol);
                        nvrow.push(nvcol);
                    }

                    vals.push(vrow);
                    nvals.push(nvrow);
                }

                mainrect = new createjs.Shape();
                stage.addChild(mainrect);
                stage.update();

                xscale = stage.canvas.width / cols;
                yscale = stage.canvas.height / rows;

                createjs.Ticker.addEventListener("tick", tick);
                createjs.Ticker.setFPS(10);
            }

            function iterate_cells(channel, effect, fun) {
                for (var row = 0; row < rows; row++) {
                    for (var col = 0; col < cols; col++) {
                        p = {
                            row: row,
                            col: col,
                            channel: channel,
                            effect: effect,
                            up: (rows + row - 1) % rows,
                            down: (rows + row + 1) % rows,
                            left: (cols + col - 1) % cols,
                            right: (cols + col + 1) % cols
                        }

                        p.v = [
                            [
                                vals[p.up][p.left][channel],
                                vals[p.up][p.col][channel],
                                vals[p.up][p.right][channel]
                            ],
                            [
                                vals[p.row][p.left][channel],
                                vals[p.row][p.col][channel],
                                vals[p.row][p.right][channel],
                            ],
                            [
                                vals[p.down][p.left][channel],
                                vals[p.down][p.col][channel],
                                vals[p.down][p.right][channel]
                            ]
                        ]

                        fun(p);
                    }
                }
            }


            function swap(row1, col1, row2, col2, lt, channel) {
                a = vals[row1][col1][channel];
                b = vals[row2][col2][channel];

                if ((lt && a < b) || (!lt && a > b)) {
                    vals[row1][col1][channel] = b;
                    vals[row2][col2][channel] = a;
                }
            }

            function tick() {
                /* Run each effect for each channel. */
                for (var channel = 0; channel < 4; channel ++) {
                    for (var e = 0; e < effects.length; e++) {
                        effect = effects[e];

                        // Randomize direction / transition probabilities.
                        if (Math.random() < effect.p[channel]) {
                            effect.direction[channel] = Math.floor(
                                Math.random() * 3.0
                            ) - 1;

                            effect.p[channel] = Math.random() * (
                                effect.pMax - effect.pMin
                            ) + effect.pMin;
                        }

                        // Run the effect.
                        iterate_cells(channel, effect, effect.update);

                        // Update values if desired.
                        if (effect.postUpdate) {
                            iterate_cells(channel, effect, function(p) {
                                vals[p.row][p.col][p.channel] =
                                    nvals[p.row][p.col][p.channel];
                            })
                        }
                    }
                }

                /* Draw this frame. */
                mainrect.graphics.clear();

                for (var row = 0; row < rows; row++) {
                    for (var col = 0; col < cols; col++) {
                        var color = hsla(
                            Math.floor(vals[row][col][0] / 100. * 360),
                            Math.floor(vals[row][col][1] / 3 + 33),
                            Math.floor(vals[row][col][2] / 3 + 33),
                            vals[row][col][3] / 200.
                        );

                        mainrect.graphics.beginFill(color).drawCircle(
                            xscale * col + (xscale / 2),
                            yscale * row + (yscale / 2),
                            Math.min(xscale, yscale) / 3
                        );
                    }
                }

                stage.update();
            }
        </script>

        <style>
            body {
                font-family: 'Open Sans', 'sans-serif';
                font-weight: 300;
            }

            a {
                color: inherit;
                text-decoration: none;
            }

            .container {
                width: 38em;
                margin: auto;
                height: 32em;
                margin-top: 5em;
            }

            .easel {
                display: inline-block;

                width: 5em;
                margin-right: 1em;
                background: white;
                height: 32em;
                vertical-align: top;
            }

            .content {
                display: inline-block;
                width: 28em;
                vertical-align: top;
             }

            /* Header. */

            .profile {
                margin: 0;
                padding: 0;
            }

            .profile h1 {
                font-family: 'Molengo', 'sans-serif';
                font-size: 2em;
                letter-spacing: 0.37em;
                text-transform: lowercase;
                /*line-height: 0.25em;*/
                color: #556270;
                margin: 0;
                padding: 0;
                overflow: hidden;
                height: 0.65em;
                line-height: 0.4em;
                text-align: center;
            }

            /* Biography text. */

            .bio {
                text-align: justify;
                margin: 0;
                margin-top: 2em;
            }

            .bio ul {
                padding: 0;
                margin: 0;
            }

            .bio ul ul {
                padding: 1em;
            }

            .bio li {
                list-style-type: none;
                margin-top: .5em;
            }

            .bio a {
                color: #81997F;
            }

            .page {
                text-align: right;
                color: #556270;
            }

            .page img {
                position: relative;
                top: -0.5em;
                left: 2.25em;
            }
        </style>
    </head>
    <body onload="init();">
        <div class='container'>
            <canvas class='easel' id='easel' width="50" height="320"></canvas>
            <div class='content'>
                <section class='profile'>
                    <h1>Brandon <span class='lastname'>Mechtley</span></h1>
                </section>
                <section class='bio'>
                    <ul>
                        <li>&quot;is&quot;
                            <ul>
                                <li>inspired by <a href='media/alan-watts-seeing.mp3'>wiggles</a>, <a href='https://soundcloud.com/bmechtley/noise'>noise</a>, and <a href='https://www.youtube.com/watch?v=pcHnL7aS64Y'>silence</a>.</li>
                                <li>working on computational models of population ecology at the <a href="http://kbs.ku.edu">Kansas Biological Survey</a> at the University of Kansas.</li>
                            </ul>
                        </li>

                        <li>&quot;has&quot;
                            <ul>
                                <li>an ongoing <a href='https://vimeo.com/94695852'>soundscape mapping project</a>.</li>
                                <li>a <a href='maps/index.html'>list of sound maps on the web</a>.</li>
                                <li>some <a href='http://www.mendeley.com/profiles/brandon-mechtley/'>papers</a>.</li>
                                <li>some <a href='https://soundcloud.com/bmechtley'>sounds</a>.</li>
                                <li>a <a href='cv.html'>cv</a>.</li>
                            </ul>
                        </li>
                    </ul>

                    <p class='page'><img src='images/music.png'/>00001</p>
                </section>
            </div>
        </div>
    </body>
</html>

